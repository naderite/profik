{"version":3,"names":["useRef","useSharedValue","getTag","getShadowNodeWrapperFromHostInstance","makeShareableCloneRecursive","registerShareableMapping","getShareableShadowNodeFromComponent","component","getTagValueFunction","global","_IS_FABRIC","useAnimatedRef","tag","ref","current","fun","value","remoteRef","__init"],"sources":["useAnimatedRef.ts"],"sourcesContent":["import { Component, useRef } from 'react';\nimport { useSharedValue } from './useSharedValue';\nimport { RefObjectFunction } from './commonTypes';\nimport { ShadowNodeWrapper } from '../commonTypes';\nimport { getTag } from '../NativeMethods';\nimport { getShadowNodeWrapperFromHostInstance } from '../fabricUtils';\nimport {\n  makeShareableCloneRecursive,\n  registerShareableMapping,\n} from '../shareables';\n\nfunction getShareableShadowNodeFromComponent(\n  component: Component\n): ShadowNodeWrapper {\n  return getShadowNodeWrapperFromHostInstance(component);\n}\n\nconst getTagValueFunction = global._IS_FABRIC\n  ? getShareableShadowNodeFromComponent\n  : getTag;\n\nexport function useAnimatedRef<T extends Component>(): RefObjectFunction<T> {\n  const tag = useSharedValue<number | ShadowNodeWrapper | null>(-1);\n  const ref = useRef<RefObjectFunction<T>>();\n\n  if (!ref.current) {\n    const fun: RefObjectFunction<T> = <RefObjectFunction<T>>((component) => {\n      // enters when ref is set by attaching to a component\n      if (component) {\n        tag.value = getTagValueFunction(component);\n        fun.current = component;\n      }\n      return tag.value;\n    });\n\n    fun.current = null;\n\n    const remoteRef = makeShareableCloneRecursive({\n      __init: () => {\n        'worklet';\n        return () => tag.value;\n      },\n    });\n    registerShareableMapping(fun, remoteRef);\n\n    ref.current = fun;\n  }\n\n  return ref.current;\n}\n"],"mappings":"AAAA,SAAoBA,MAAM,QAAQ,OAAO;AACzC,SAASC,cAAc,QAAQ,kBAAkB;AAGjD,SAASC,MAAM,QAAQ,kBAAkB;AACzC,SAASC,oCAAoC,QAAQ,gBAAgB;AACrE,SACEC,2BAA2B,EAC3BC,wBAAwB,QACnB,eAAe;AAEtB,SAASC,mCAAmCA,CAC1CC,SAAoB,EACD;EACnB,OAAOJ,oCAAoC,CAACI,SAAS,CAAC;AACxD;AAEA,MAAMC,mBAAmB,GAAGC,MAAM,CAACC,UAAU,GACzCJ,mCAAmC,GACnCJ,MAAM;AAEV,OAAO,SAASS,cAAcA,CAAA,EAA8C;EAC1E,MAAMC,GAAG,GAAGX,cAAc,CAAoC,CAAC,CAAC,CAAC;EACjE,MAAMY,GAAG,GAAGb,MAAM,EAAwB;EAE1C,IAAI,CAACa,GAAG,CAACC,OAAO,EAAE;IAChB,MAAMC,GAAyB,GAA2BR,SAAS,IAAK;MACtE;MACA,IAAIA,SAAS,EAAE;QACbK,GAAG,CAACI,KAAK,GAAGR,mBAAmB,CAACD,SAAS,CAAC;QAC1CQ,GAAG,CAACD,OAAO,GAAGP,SAAS;MACzB;MACA,OAAOK,GAAG,CAACI,KAAK;IAClB,CAAE;IAEFD,GAAG,CAACD,OAAO,GAAG,IAAI;IAElB,MAAMG,SAAS,GAAGb,2BAA2B,CAAC;MAC5Cc,MAAM,EAAEA,CAAA,KAAM;QACZ,SAAS;;QACT,OAAO,MAAMN,GAAG,CAACI,KAAK;MACxB;IACF,CAAC,CAAC;IACFX,wBAAwB,CAACU,GAAG,EAAEE,SAAS,CAAC;IAExCJ,GAAG,CAACC,OAAO,GAAGC,GAAG;EACnB;EAEA,OAAOF,GAAG,CAACC,OAAO;AACpB"}